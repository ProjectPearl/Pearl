{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PEARL Experiment Schema",
  "version": "0.2",
  "description": "Schema for real-world embodied learning experiments. Breaking changes require major version bump.",
  "type": "object",
  "required": [
    "schema_version",
    "experiment_id",
    "timestamp",
    "contributor",
    "task",
    "hardware",
    "environment",
    "outcome",
    "reward"
  ],
  "properties": {
    "schema_version": {
      "type": "string",
      "enum": ["0.1", "0.2"],
      "description": "Schema version this experiment conforms to"
    },
    "experiment_id": {
      "type": "string",
      "pattern": "^[0-9]{4}_[a-z0-9_]+$",
      "description": "Unique identifier (format: NNNN_descriptive_name)"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of when experiment was conducted"
    },
    "contributor": {
      "type": "string",
      "minLength": 1,
      "description": "GitHub username (required, no anonymous submissions)"
    },
    "parent_experiment": {
      "type": "string",
      "description": "Reference to previous experiment this builds on (lineage tracking)"
    },
    "task": {
      "type": "object",
      "required": ["type", "description"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["balance", "navigation", "grasping", "locomotion", "tracking", "avoidance", "other"],
          "description": "Canonical task type"
        },
        "description": {
          "type": "string",
          "minLength": 10,
          "description": "Specific task description (min 10 chars)"
        },
        "success_criteria": {
          "type": "string",
          "description": "What counts as success for this task"
        }
      }
    },
    "hardware": {
      "type": "object",
      "required": ["platform", "mcu", "motors", "power_source", "sensors", "actuators"],
      "properties": {
        "platform": {
          "type": "string",
          "description": "Robot platform type (e.g., '2-wheel differential', '4-wheel mecanum')"
        },
        "mcu": {
          "type": "string",
          "description": "Microcontroller (e.g., 'ESP32-WROOM-32', 'Arduino Nano')"
        },
        "motors": {
          "type": "string",
          "description": "Motor type and specs (e.g., 'N20 DC 6V 100RPM')"
        },
        "power_source": {
          "type": "string",
          "description": "Power source (e.g., '2S LiPo 7.4V 1000mAh')"
        },
        "sensors": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1,
          "description": "List of sensors used"
        },
        "actuators": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1,
          "description": "List of actuators used"
        },
        "cost_usd": {
          "type": "number",
          "minimum": 0,
          "description": "Total hardware cost in USD"
        },
        "hardware_id": {
          "type": "string",
          "description": "Hash of hardware config for cross-experiment comparison"
        }
      }
    },
    "environment": {
      "type": "object",
      "required": ["surface", "lighting", "load"],
      "properties": {
        "surface": {
          "type": "string",
          "enum": ["tile", "carpet", "wood", "concrete", "dirt", "grass", "other"],
          "description": "Operating surface type"
        },
        "lighting": {
          "type": "string",
          "enum": ["indoor_artificial", "indoor_natural", "outdoor_day", "outdoor_night", "mixed"],
          "description": "Lighting conditions"
        },
        "load": {
          "type": "string",
          "enum": ["none", "light", "medium", "heavy"],
          "description": "Payload load on robot"
        },
        "temperature_c": {
          "type": "number",
          "description": "Ambient temperature in Celsius"
        },
        "humidity_percent": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Relative humidity percentage"
        },
        "notes": {
          "type": "string",
          "description": "Additional environment notes"
        }
      }
    },
    "sensors_data": {
      "type": "object",
      "description": "Raw sensor data collected during experiment",
      "additionalProperties": {
        "type": "array",
        "items": { "type": "number" }
      }
    },
    "actions": {
      "type": "array",
      "description": "Actions taken during experiment",
      "items": {
        "type": "object",
        "required": ["timestamp", "action_type", "values"],
        "properties": {
          "timestamp": { "type": "number" },
          "action_type": { "type": "string" },
          "values": {
            "type": "array",
            "items": { "type": "number" }
          }
        }
      }
    },
    "outcome": {
      "type": "object",
      "required": ["success", "duration_seconds"],
      "properties": {
        "success": {
          "type": "boolean",
          "description": "Whether the experiment achieved its goal"
        },
        "duration_seconds": {
          "type": "number",
          "minimum": 0,
          "description": "Duration of experiment in seconds"
        },
        "failure_mode": {
          "type": "string",
          "enum": [
            "control_instability",
            "mechanical_slip",
            "perception_error",
            "actuator_saturation",
            "power_dropout",
            "sensor_noise",
            "communication_loss",
            "environmental_interference",
            "timeout",
            "collision",
            "other",
            null
          ],
          "description": "Standardized failure category (null if success)"
        },
        "failure_description": {
          "type": "string",
          "description": "Detailed description of what went wrong"
        },
        "metrics": {
          "type": "object",
          "additionalProperties": { "type": "number" }
        }
      }
    },
    "reward": {
      "type": "number",
      "description": "Reward signal (required, can be negative)"
    },
    "notes": {
      "type": "string",
      "description": "Free-form notes about the experiment"
    },
    "reproducibility": {
      "type": "object",
      "description": "Auto-calculated reproducibility indicators",
      "properties": {
        "hardware_detail_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "environment_detail_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "data_completeness_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    }
  },
  "additionalProperties": false
}
